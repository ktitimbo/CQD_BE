# Numerical computation of the fraction of spin flip in the Frisch-Segr√® experiment using co-quantum dynamics theory

August, 2022

### Authors

 - K. Titimbo
 - D.C. Garrett
 - S.S. Kahraman
 - Z. He
 - L.V. Wang

### Affiliation

Caltech Optical Imaging Laboratory, Andrew and Peggy Cherng Department of Medical Engineering, Department of Electrical Engineering, California Institute of Technology, 1200 E. California Blvd., MC 138-78, Pasadena, CA 91125, USA


## Description

This repository contains `FS-BE-spinflip.jl`, it computes the fraction of spin flip as in the [Frisch-Segre experiment](https://link.springer.com/article/10.1007/BF01335699) using the [co-quantum dynamics](https://arxiv.org/abs/2208.06471) concepts. The details and results are [discussed here](https://arxiv.org/abs/2208.13444).

We model the dynamics of the electron and nucleus magnetic moment of single potassium-39 atoms entering the so-called inner rotation chamber, where a varying weak magnetic field is present. The dynamical equation for the magnetic moments is the Bloch equation, while the interaction between the magnetic moments is described by means of the torque-average magnetic field generated by the opposite system.

The Julia code generates 3 files as outputs:
1. Data (.csv file): organized as follow

<table class="centerTable" border="3">
  <tr>
    <td rowspan="2" style="text-align:center;"><i>n<i><//td>
    <td colspan="2" style="text-align:center;"><b>Initial conditions<b></td>
    <th style="text-align:center;" colspan="5" >$I_{1}$</th>
    <td colspan="5" >$...$</td>
    <th colspan="5" >$I_{8}$</th>
  </tr>
  <tr>
    <td>$\theta_{n,0}$</td>
    <td>$\phi_{n,0}$</td>
    <td>$\theta_{e}$</td>
    <td>$\phi_{e}$</td>
    <td>$\theta_{n}$</td>
    <td>$\phi_{n}$</td>
    <td><i>flip<i></td>
    <td colspan="5" style="text-align:center;">...</td>
    <td>$\theta_{e}$</td>
    <td>$\phi_{e}$</td>
    <td>$\theta_{n}$</td>
    <td>$\phi_{n}$</td>
    <td><i>flip<i></td>
  </tr>
  <tr>
    <td>1</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td colspan="5"> </td>
    <td> </td>
    <td> </td>
    <td> </td>
    <td> </td>
    <td> </td>
  </tr>
  <tr>
    <td>$\vdots$</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td colspan="5"> </td>
    <td> </td>
    <td> </td>
    <td> </td>
    <td> </td>
    <td> </td>
  </tr>
  <tr>
    <td>$N$</td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td colspan="5"> </td>
    <td> </td>
    <td> </td>
    <td> </td>
    <td> </td>
    <td> </td>
  </tr>
</table>


2. Summary (.txt file): contains *metadata* about the parameters used for the simulation
```
Experiment 	=	Frisch-Segre 
filename	=	FS_curr_15000_20220816T143123 
ODE System	=	BE3 
ensemble	=	currents 
coord.  	=	spherical 
Excep.Hand	=	wrapping 
z_a	        =	0.000105 
k_i	        =	0 
field	        =	quadrupole 
ang. dist.	=	hs 
N sampling	=	15000 
time span	=	(-11.0, 20.0) us 
tiny angle	=	1.0e-6 
reltol	        =	1.0e-10 
abstol	        =	1.0e-10 
dtmin	        =	1.0e-40 
start date	=	2022-08-16T14-31-23
end date	=	2022-08-17T08-07-47
run time	=	17 hours, 36 minutes, 23 seconds, 249 milliseconds 
hostname	=	COMPUTERNAME 
Code name	=	FS_BE_spinflip.jl 
flip prob	=	[0.003533, 0.057071, 0.14867, 0.268067, 0.333, 0.2374, 0.113267, 0.0668]
```
     
3. Fraction Spin flip obtained from the code compared with the experimental data reported by Frisch and Segre (.png file)


Typical figure generated is as this one [^1] 

![alt text](https://github.com/ktitimbo/FrischSegre-CQD-BE/blob/main/FS_curr_15000_20220816T143123.png?raw=true)


[^1]: Obtained sampling *N*=15000 atoms via Monte Carlo method
